### Пример горизонтального шардирования БД
 
В данном проекте реализован пример шардирования базы данных 
на основе бизнес сущности информации о файлах проверки.

Бизнес сущьность "Файл проверки" представлен классом 
*ru.avn.sharding.repositories.entities.AuditFile*. 
Файл имеет следующие атрибуты: 
 - id (уникальный идентификатор)
 - contentId (идентификатор контента файла в файлом хранилище)
 - auditCode (код провери)
 - filename (имя файла)
 - type (тип файла проверки)
 - isAttachment (является ли файл приложением к проверке)
 - auditQuestions (перечень вопросов проверок, относящиеся к файлу)
 - createdAt (дата создания записи в бд о файле)
 
Для вычисления номера шарда используется атрибут файла проверики type.
Type является символом и может принимать значения от A до Z. 
Для простоты решения функции шардирования считаем, что количество файлов каждого 
типа равномерно распредеделено. 
Таким образом вычисление номера шарда по атрибуту type можно представить следующим образом:
     
     shard_index = type % number_of_shards
     
#### Описание API в примере.

POST /api/v1/audit_files - сохранение информации о файле в бд
GET  /api/v1/audit_files/{uuid} - получение информации о файле
GET  /api/v1/audit_files/search - поиск информации о файле

GET  /generator/{size} - создаёт в бд тестовые данные по файлам
GET  /api/v1/shards - получение информации о шардах и количестве файлов в
разрезе типа на каждой из шард.  

#### Запуск примера

Пример запускает три ноды. 

Две ноды являются шардированными репозиториями, 
а третья является проксирующей нодой. 

Rest запросы поступают на проксирующую ноду, 
далее вычисляется по критерию поиска номер шарды и запрос проксируется на соответсвующую ноду или ноды, 
либо если критерий поиска с Type не задан, то запрос проксируется на все shard-ноды.

- Если выполнить /api/v1/audit_files/search - запрос перейдет на две ноды, далее результаты 
склеиваются и возвращаются пользователю
- Если выполнить /api/v1/audit_files/search?type=A - запрос перейдет на одну из нод


Перейти в папку appdist


    docker build -t avn/sharding:1.0 .
    docker-compose up -d


##### Чего нет в примере

- оптимизации
- логирования
- постраничного вывода
- обработки ошибок
- настройки таймаутов http соединений
- решардинга
- и много чего еще, это просто пример. 
